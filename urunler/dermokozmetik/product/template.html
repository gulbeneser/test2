<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ürün Detayı | Dermokozmetik | Serakıncı</title>
  <meta name="description" content="Serakıncı'da dermokozmetik ürünleri. En sevdiğiniz markaların ürün detaylarını inceleyin.">
  <link rel="canonical" href="https://www.serakinci.com/">

  <link rel="icon" href="/urunler/assets/logos/logobrowser/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="16x16" href="/urunler/assets/logos/logobrowser/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/urunler/assets/logos/logobrowser/favicon-32x32.png">
  <link rel="apple-touch-icon" href="/urunler/assets/logos/logobrowser/apple-icon.png">
  <!-- Diğer favicon linkleri buraya gelecek (kısaltıldı) -->
  <link rel="apple-touch-icon-precomposed" href="/urunler/assets/logos/logobrowser/apple-icon-precomposed.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/urunler/assets/logos/logobrowser/android-icon-192x192.png">
  <meta name="msapplication-TileColor" content="#212A40">
  <meta name="msapplication-TileImage" content="/urunler/assets/logos/logobrowser/android-icon-144x144.png">
  <meta name="msapplication-config" content="/urunler/assets/logos/logobrowser/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  <link rel="manifest" href="/urunler/assets/logos/logobrowser/manifest.json">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "Yükleniyor...",
    "description": "Yükleniyor...",
    "image": "",
    "offers": {
      "@type": "Offer",
      "priceCurrency": "TRY",
      "price": "0.00",
      "availability": "https://schema.org/InStock"
    },
    "brand": {
      "@type": "Brand",
      "name": "Yükleniyor..."
    }
  }
  </script>
  <meta property="og:title" content="Ürün Detayı | Dermokozmetik | Serakıncı">
  <meta property="og:description" content="Serakıncı'da dermokozmetik ürünleri. En sevdiğiniz markaların ürün detaylarını inceleyin.">
  <meta property="og:type" content="og:product">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Serakıncı">
  <meta property="og:locale" content="tr_TR">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ürün Detayı | Dermokozmetik | Serakıncı">
  <meta name="twitter:description" content="Serakıncı'da dermokozmetik ürünleri. En sevdiğiniz markaların ürün detaylarını inceleyin.">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Satoshi:wght@400;500;700&display=swap" rel="stylesheet">
  
  <script type="importmap">
  {
    "imports": {
      "@google/genai": "https://esm.sh/@google/generative-ai"
    }
  }
  </script>

  <style>
    :root {
      --primary-theme: #50C8C6; 
      --primary-theme-hover: #40A8A6;
      
      --background: #f8f9fa;
      --card-bg: #ffffff;
      --text-dark: #212529;
      --text-medium: #495057;
      --text-light: #6c757d;
      --border-color: #dee2e6;
      --radius: 0.375rem;
      --shadow-sm: 0 .125rem .25rem rgba(0,0,0,.075);
      --shadow-md: 0 .5rem 1rem rgba(0,0,0,.1);

      --original-header-bg: #ffffff;
      --original-header-text-color: #1C274C;
      --original-header-nav-link-color: #1C274C;
      --original-header-nav-link-hover-color: #50C8C6;
      --original-header-lang-button-bg: #ffffff;
      --original-header-lang-button-border: #ADD8E6;
      --original-header-lang-button-text: #1C274C;
      --original-header-lang-button-hover-bg: #f0f8ff;
      --original-header-b2b-button-bg: #212A40;
      --original-header-b2b-button-text: #ffffff;
      --original-header-b2b-button-hover-bg: #303E5C;
      --original-header-border-color: #e0e6e8;
    }
    html {
      scroll-behavior: smooth;
      box-sizing: border-box;
    }
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: inherit;
      overflow-wrap: break-word;
    }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: var(--text-dark);
      background-color: var(--background);
      line-height: 1.6;
      overflow-x: hidden;
      -webkit-font-smoothing:antialiased;
    }
    img, svg, video, canvas, iframe, embed, object {
        max-width: 100%;
        height: auto;
        display: block;
    }
    .container {
      max-width: 1140px;
      margin: 0 auto;
      padding: 1.5rem 1rem;
    }
    @media (max-width: 767px) {
      .container { padding: 1rem 0.75rem; }
    }

    .new-site-header {
      font-family: 'Satoshi', sans-serif;
      --radius-header: 6px; 
      --shadow-header: 0 2px 6px rgba(44, 62, 80, .07);
      --shadow-md-header: 0 3px 10px rgba(44, 62, 80, .09);
      background-color: var(--original-header-bg);
      padding: 0.8rem 0;
      border-bottom: 1px solid var(--original-header-border-color);
      box-shadow: var(--shadow-header);
      position: sticky;
      top: 0;
      z-index: 1030;
    }
    .new-header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width:1100px;
      margin:0 auto;
      padding: 0 1.5rem; 
    }
    .new-site-logo-link {
      display: flex;
      align-items: center;
      text-decoration: none;
      flex-shrink: 0;
    }
    .new-site-logo-img {
      height: 36px;
      margin-right: 0.6rem;
    }
    .new-site-logo-text {
      font-size: 1.3rem;
      font-weight: 500;
      color: var(--original-header-text-color);
      white-space: nowrap;
    }
    .new-site-navigation {
      display: flex;
      gap: 1.5rem;
    }
    .new-nav-link {
      color: var(--original-header-nav-link-color);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
      padding: 0.3rem 0;
      position: relative;
      transition: color 0.2s ease;
    }
    .new-nav-link:hover {
      color: var(--original-header-nav-link-hover-color);
      text-decoration: none;
    }
    .new-nav-link::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -2px;
      left: 0;
      background-color: var(--original-header-nav-link-hover-color);
      transition: width 0.3s ease;
    }
    .new-nav-link:hover::after {
      width: 100%;
    }
    .new-header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-shrink: 0;
    }
    .language-selector {
      background-color: var(--original-header-lang-button-bg);
      border: 1px solid var(--original-header-lang-button-border);
      color: var(--original-header-lang-button-text);
      padding: 0.4rem 0.8rem;
      border-radius: var(--radius-header);
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .language-selector:hover {
      background-color: var(--original-header-lang-button-hover-bg);
    }
    .new-site-header .search-button {
      background: none;
      border: none;
      color: var(--original-header-text-color);
      cursor: pointer;
      padding: 0.3rem;
      display: flex;
      align-items: center;
    }
    .new-site-header .search-button svg {
      width: 20px;
      height: 20px;
      stroke-width: 2.2px;
    }
    .new-site-header .search-button:hover svg {
      color: var(--original-header-nav-link-hover-color);
    }
    .b2b-login-button {
      background-color: var(--original-header-b2b-button-bg);
      color: var(--original-header-b2b-button-text);
      padding: 0.5rem 1.2rem;
      border-radius: 20px;
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
      transition: background-color 0.2s ease;
      white-space: nowrap;
    }
    .b2b-login-button:hover {
      background-color: var(--original-header-b2b-button-hover-bg);
      text-decoration: none;
      color: var(--original-header-b2b-button-text);
    }
    .mobile-menu-toggle {
        display: none; 
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
    }
    .mobile-menu-toggle svg {
        width: 24px;
        height: 24px;
        stroke: var(--original-header-text-color);
    }
    @media(max-width: 992px) {
      .new-site-navigation {
        display: none; 
        flex-direction: column;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        width: 100%;
        background-color: var(--original-header-bg);
        padding: 1rem;
        box-shadow: var(--shadow-md-header);
        z-index: 1025;
        border-top: 1px solid var(--original-header-border-color);
      }
      .new-site-navigation.is-active {
        display: flex; 
      }
      .mobile-menu-toggle { display: block; } 
      .new-header-content { padding: 0 1rem; }
    }
    @media(max-width: 768px) {
      .new-site-logo-text { font-size: 1.15rem; }
      .new-site-logo-img { height: 32px; }
      .language-selector, .b2b-login-button { padding: 0.35rem 0.7rem; font-size: 0.8rem; }
      .new-header-actions { gap: 0.7rem; }
    }
    @media(max-width: 480px) {
      .new-site-logo-text {
        font-size: 1rem;
        margin-left: 0.4rem;
      }
      .new-site-logo-img {
        height: 30px;
      }
      .new-header-actions { gap: 0.4rem; }
      .b2b-login-button { padding: 0.3rem 0.5rem; font-size: 0.7rem;}
      .language-selector { padding: 0.3rem 0.5rem; font-size: 0.7rem;}
      .new-site-header .search-button svg { width: 17px; height: 17px;}
    }

    .product-search-header {
        background-color: var(--card-bg);
        padding: 1rem 0;
        box-shadow: var(--shadow-sm);
        margin-bottom: 1.5rem;
    }
    .search-bar-container {
        max-width: 700px;
        margin: 0 auto;
        padding: 0 1rem; 
        position: relative; 
    }
    .search-input-wrapper {
        display: flex;
        align-items: center;
        background-color: #f1f3f5;
        border-radius: var(--radius);
        padding: 0.5rem 1rem;
        border: 1px solid var(--border-color);
    }
    .search-input-wrapper svg {
        margin-right: 0.75rem;
        color: var(--text-light);
        width: 20px;
        height: 20px;
        flex-shrink: 0;
    }
    #productSearchInput {
        width: 100%;
        border: none;
        outline: none;
        font-size: 1rem;
        padding: 0.5rem 0;
        background-color: transparent;
        color: var(--text-dark);
    }
    #productSearchInput::placeholder {
        color: var(--text-light);
    }
    #searchResultsDropdown {
        position: absolute;
        top: calc(100% + 5px); 
        left: 0;
        right: 0;
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-top: none;
        border-radius: 0 0 var(--radius) var(--radius);
        box-shadow: var(--shadow-md);
        max-height: 350px;
        overflow-y: auto;
        z-index: 1010; 
        display: none; 
    }
    #searchResultsDropdown ul { list-style: none; padding: 0; margin: 0; }
    #searchResultsDropdown li a { display: flex; align-items: center; padding: 0.75rem 1rem; text-decoration: none; color: var(--text-dark); border-bottom: 1px solid var(--border-color); transition: background-color 0.2s; }
    #searchResultsDropdown li:last-child a { border-bottom: none; }
    #searchResultsDropdown li a:hover { background-color: #e9ecef; }
    #searchResultsDropdown .suggestion-image { width: 40px; height: 40px; object-fit: contain; margin-right: 0.75rem; border-radius: var(--radius); border: 1px solid var(--border-color); background-color: #fff; }
    #searchResultsDropdown .suggestion-name { font-weight: 500; flex-grow: 1; }
    #searchResultsDropdown .suggestion-category { font-size: 0.8rem; color: var(--text-light); margin-left: 0.5rem; white-space: nowrap; }
    #searchResultsDropdown .no-results { padding: 1rem; text-align: center; color: var(--text-medium); }

    .breadcrumbs { display: flex; align-items: center; flex-wrap: wrap; font-size: 0.875rem; margin-bottom: 1.5rem; padding: 0.5rem 0; color: var(--text-medium); }
    .breadcrumb-link { color: var(--primary-theme); text-decoration: none; transition: color 0.2s; }
    .breadcrumb-link:hover { text-decoration: underline; color: var(--primary-theme-hover); }
    .breadcrumb-separator { margin: 0 0.5rem; color: var(--text-light); font-size: 0.9em; }
    .breadcrumb-current { color: var(--text-dark); font-weight: 500; }

    .product-main-layout { display: grid; grid-template-columns: 1fr; gap: 2.5rem; margin-bottom: 2.5rem; background-color: var(--card-bg); padding: 2rem; border-radius: var(--radius); box-shadow: var(--shadow-md); }
    @media (min-width: 768px) { .product-main-layout { grid-template-columns: 2fr 3fr; gap: 2rem; } }
    @media (min-width: 992px) { .product-main-layout { grid-template-columns: 1fr 2fr; gap: 2.5rem; } }

    .product-gallery-modern .product-main-image-wrapper { cursor: pointer; }
    .product-gallery-modern { display: flex; justify-content: center; align-items: flex-start; }
    .product-main-image-wrapper { width: 100%; border: 1px solid var(--border-color); border-radius: var(--radius); overflow: hidden; background-color: #fff; box-shadow: var(--shadow-sm); }
    .product-main-image-modern { display: block; width: 100%; height: auto; aspect-ratio: 1 / 1; object-fit: contain; padding: 0.5rem; }

    .product-info-modern { display: flex; flex-direction: column; }
    .product-title-wrapper { display: flex; align-items: center; flex-wrap: wrap; margin-bottom: 0.75rem;}
    .product-title-modern { font-size: 2rem; font-weight: 700; color: var(--text-dark); line-height: 1.3; margin:0 0.5rem 0 0; }
    
    .favorite-button { background: none; border: none; cursor: pointer; padding: 0.3rem; color: var(--text-light); transition: color 0.2s, transform 0.2s; display: inline-flex; align-items: center; }
    .favorite-button svg { width: 24px; height: 24px; fill: currentColor; }
    .favorite-button:hover { color: #e74c3c; transform: scale(1.1); }
    .favorite-button.favorited { color: #e74c3c; }
    .favorite-tooltip, .copy-tooltip { position: fixed; background-color: rgba(51,51,51,0.9); color: white; padding: 6px 12px; border-radius: 4px; font-size: 0.85em; z-index: 1070; opacity: 0; transition: opacity 0.3s, transform 0.3s; pointer-events: none; white-space: nowrap; transform: translateY(10px); }
    .favorite-tooltip.show, .copy-tooltip.show { opacity: 1; transform: translateY(0); }

    .product-meta-enhanced { font-size: 0.9rem; color: var(--text-medium); margin-bottom: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem 1.5rem; }
    .product-meta-enhanced .meta-item { display: flex; align-items: center; }
    .product-meta-enhanced .meta-item strong { color: var(--text-dark); font-weight: 600; margin-right: 0.3rem; }
    .product-meta-enhanced .meta-item .copy-code { margin-left: 0.5rem; cursor: pointer; color: var(--primary-theme); font-size: 0.85em; border: 1px solid transparent; padding: 0.1rem 0.2rem; border-radius: 0.2rem; }
    .product-meta-enhanced .meta-item .copy-code:hover { color: var(--primary-theme-hover); background-color: #e9f4ff; }

    .product-share-buttons { margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.75rem; }
    .product-share-buttons .share-label { font-size: 0.9rem; font-weight: 500; color: var(--text-medium); margin-right: 0.25rem; }
    .product-share-buttons a { display: inline-flex; align-items:center; justify-content:center; transition: opacity 0.2s, transform 0.2s; width: 28px; height: 28px; }
    .product-share-buttons a:hover { opacity: 0.7; transform: scale(1.1); }
    .product-share-buttons svg { width: 100%; height: 100%; } 

    .product-short-description { font-size: 1rem; color: var(--text-medium); margin-bottom: 1rem; line-height: 1.7; }
    
    /* YENİ: AI Bilgi Alanı Stilleri */
    #aiProductInfo { margin-top: 1rem; margin-bottom:1.5rem; padding: 1rem; background-color: #e6f7ff; /* Temaya uygun açık mavi */ border-left: 4px solid var(--primary-theme); border-radius: var(--radius); font-size: 0.9375rem; }
    #aiProductInfo h4 { font-size: 1.15rem; color: var(--text-dark); margin-top: 0; margin-bottom: 0.75rem; font-weight: 600; }
    #aiProductInfo p { margin-bottom: 0.75rem; line-height: 1.6; }
    #aiProductInfo ul { padding-left: 1.2rem; margin-bottom: 0; }
    #aiProductInfo li { margin-bottom: 0.35rem; }
    #aiProductInfo.error-message { background-color: #fff3cd; border-left-color: #ffe082; color: #664d03; }
    #aiProductInfoPlaceholder { margin-top: 1rem; margin-bottom:1.5rem; font-size: 0.9375rem; }
    #aiProductInfoPlaceholder p { font-style: italic; color: var(--text-medium); padding: 1rem; background-color: #f8f9fa; border: 1px dashed var(--border-color); border-radius: var(--radius); }


    .product-details-tabs-modern { background-color: var(--card-bg); padding: 0; border-radius: var(--radius); box-shadow: var(--shadow-md); margin-bottom: 2.5rem; overflow: hidden; }
    .tabs-navigation-modern { display: flex; border-bottom: 1px solid var(--border-color); background-color: #f8f9fa; overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch; scrollbar-width: thin; scrollbar-color: var(--primary-theme) #f1f3f5; }
    .tabs-navigation-modern::-webkit-scrollbar { height: 6px; }
    .tabs-navigation-modern::-webkit-scrollbar-thumb { background-color: var(--primary-theme); border-radius: 3px; }
    .tabs-navigation-modern::-webkit-scrollbar-track { background-color: #f1f3f5; }

    .tab-link-modern { font-family: 'Inter', sans-serif; padding: 1rem 1.5rem; cursor: pointer; border: none; background-color: transparent; color: var(--text-medium); font-size: 1rem; font-weight: 600; position: relative; border-bottom: 3px solid transparent; transition: color 0.2s, border-color 0.2s, background-color 0.2s; margin-bottom: -1px; flex-shrink: 0;}
    .tab-link-modern:hover { color: var(--primary-theme); background-color: #e9ecef; text-decoration: none; }
    .tab-link-modern.active { color: var(--primary-theme); border-bottom-color: var(--primary-theme); background-color: var(--card-bg); }
    .tab-content-modern { padding: 1.5rem 2rem; }
    .tab-pane-modern { display: none; line-height: 1.7; font-size: 0.9375rem; color: var(--text-medium); }
    .tab-pane-modern.active { display: block; }
    .tab-pane-modern h3 { font-size: 1.25rem; font-weight: 700; color: var(--text-dark); margin-top: 0; margin-bottom: 1rem; }
    .tab-pane-modern p, .tab-pane-modern div, .tab-pane-modern ul { margin-bottom: 1rem; }
    .tab-pane-modern ul { padding-left: 1.5rem; }
    .tab-pane-modern strong { font-weight: 600; color: var(--text-dark); }

    .toggle-content { max-height: 100px; overflow: hidden; position: relative; transition: max-height 0.5s ease-in-out; }
    .toggle-content.expanded { max-height: 2000px; }
    .toggle-content::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 30px; background: linear-gradient(to bottom, transparent, var(--card-bg)); pointer-events: none; opacity: 1; transition: opacity 0.3s; }
    .toggle-content.expanded::after { opacity: 0; }
    .read-more-btn { display: inline-block; margin-top: 0.75rem; padding: 0.4rem 0.8rem; font-size: 0.875rem; color: var(--primary-theme); background-color: transparent; border: 1px solid var(--primary-theme); border-radius: var(--radius); cursor: pointer; transition: background-color 0.2s, color 0.2s; font-weight: 500; }
    .read-more-btn:hover { background-color: var(--primary-theme); color: white; text-decoration: none; }

    .related-products-section-modern { margin-bottom: 2.5rem; }
    .related-products-title-modern { font-size: 1.75rem; font-weight: 700; color: var(--text-dark); margin-bottom: 1.5rem; text-align: left; padding-bottom: 0.75rem; border-bottom: 2px solid var(--primary-theme); display: inline-block; }
    .related-products-carousel { position: relative; }
    .related-products-container { display: flex; overflow-x: auto; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; padding-bottom: 1rem; gap: 1.5rem; scrollbar-width: none; -ms-overflow-style: none; }
    .related-products-container::-webkit-scrollbar { display: none; }
    .related-product-card { flex: 0 0 auto; width: 240px; background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: var(--radius); box-shadow: var(--shadow-sm); overflow: hidden; text-decoration: none; color: var(--text-dark); transition: transform 0.2s, box-shadow 0.2s; display: flex; flex-direction: column; }
    .related-product-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-md); text-decoration: none; }
    .related-product-card img { width: 100%; height: 180px; object-fit: contain; padding: 0.5rem; border-bottom: 1px solid var(--border-color); background-color: #fff; }
    .related-product-card .info { padding: 1rem; flex-grow: 1; display: flex; flex-direction: column; }
    .related-product-card .name { font-size: 0.9375rem; font-weight: 600; margin-bottom: 0.25rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 2.8em; line-height: 1.4em; }
    .related-product-card .category { font-size: 0.8rem; color: var(--text-light); margin-top: auto; }
    
    .carousel-arrow { position: absolute; top: calc(50% - 10px); transform: translateY(-50%); background-color: rgba(255, 255, 255, 0.95); border: 1px solid var(--border-color); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10; box-shadow: var(--shadow-sm); transition: background-color 0.2s, transform 0.2s; }
    .carousel-arrow:hover { background-color: white; transform: translateY(-50%) scale(1.05); }
    .carousel-arrow.prev { left: -15px; }
    .carousel-arrow.next { right: -15px; }
    .carousel-arrow svg { width: 20px; height: 20px; color: var(--text-dark); }
    
    .lightbox-modal { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.9); align-items: center; justify-content: center; }
    .lightbox-modal.show { display: flex; }
    .lightbox-content { margin: auto; display: block; max-width: 90vw; max-height: 90vh; animation: lightboxZoom 0.3s ease-out; border-radius: var(--radius); }
    @keyframes lightboxZoom { from {transform: scale(0.8) translateY(20px); opacity: 0;} to {transform: scale(1) translateY(0); opacity: 1;} }
    .lightbox-close { position: absolute; top: 20px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; transition: 0.3s; cursor: pointer; user-select: none; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
    .lightbox-close:hover { color: #bbb; }

    .scroll-to-top { position: fixed; bottom: 20px; right: 20px; background-color: var(--primary-theme); color: white; border: none; border-radius: 50%; width: 48px; height: 48px; font-size: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s, transform 0.3s; z-index: 999; box-shadow: var(--shadow-md); transform: translateY(20px); }
    .scroll-to-top.show { opacity: 1; visibility: visible; transform: translateY(0); }
    .scroll-to-top:hover { background-color: var(--primary-theme-hover); }

    .loading-container, .error-container { text-align: center; padding: 3rem 1rem; background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow-md); max-width: 600px; margin: 3rem auto; }
    .loading-spinner { width: 48px; height: 48px; border: 4px solid #e9ecef; border-top: 4px solid var(--primary-theme); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1.5rem auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .loading-text { color: var(--text-medium); font-size: 1rem; }
    .error-container h2 { font-size: 1.5rem; color: var(--text-dark); margin-bottom: 0.5rem;}
    .error-container p { font-size: 1rem; color: var(--text-medium); margin-bottom: 1.5rem;}

    .back-button-modern { display: inline-flex; align-items: center; color: var(--primary-theme); text-decoration: none; margin-top: 1.5rem; font-size: 0.9375rem; transition: background-color 0.2s, color 0.2s; padding: 0.6rem 1.2rem; border: 1px solid var(--primary-theme); border-radius: var(--radius); background-color: transparent; font-weight: 500; }
    .back-button-modern:hover { background-color: var(--primary-theme); color: white; text-decoration: none; }
    .back-icon { margin-right: 0.5rem; font-size: 1.1em; }

    .disclaimer-box-modern { margin-top: 2.5rem; padding: 1.5rem; background: #fff3cd; border-radius: var(--radius); border-left: 5px solid #ffe082; color: #664d03; font-size: 0.9rem; line-height: 1.6; box-shadow: var(--shadow-sm); }
    .disclaimer-box-modern b, .disclaimer-box-modern strong { font-weight: 700; }
    .disclaimer-box-modern span { display: block; margin-top: 0.75rem;}
    .disclaimer-box-modern span:first-of-type { margin-top: 0; }

    .contact-card-modern { margin-top: 2.5rem; background: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow-md); padding: 2rem; max-width: none; }
    .contact-title-modern { font-weight: 700; font-size: 1.5rem; margin-bottom: 0.75rem; color: var(--text-dark); }
    .contact-bar-modern { border-bottom: 3px solid var(--primary-theme); width: 50px; margin-bottom: 1.5rem; }
    .contact-intro-text { color: var(--text-medium); margin-bottom: 1.5rem; font-size: 1rem; }
    .contact-grid { display: grid; gap: 1.5rem; }
    @media (min-width: 576px) { .contact-grid { grid-template-columns: 1fr 1fr; } }
    .contact-item { display:flex; align-items: flex-start; }
    .contact-item svg { color:var(--primary-theme); margin-right:1rem; flex-shrink:0; width: 24px; height: 24px; margin-top: 0.1rem; }
    .contact-label-modern { font-weight:600; color:var(--text-dark); font-size: 0.9375rem; display: block; margin-bottom: 0.25rem; }
    .contact-link-modern { color:var(--primary-theme); text-decoration:none; font-size:1rem;}
    .contact-link-modern:hover { text-decoration: underline; color: var(--primary-theme-hover); }
    .contact-address-text { font-size:1rem; color: var(--text-medium); line-height: 1.5; }
    
    .firm-social-media { margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color); }
    .firm-social-media .social-label { font-weight: 600; font-size: 1.125rem; color:var(--text-dark); margin-bottom: 0.75rem; display:block; }
    .firm-social-media-row { display:flex; gap:1rem; align-items: center;}
    .firm-social-media-row a { display:inline-flex; align-items:center; justify-content:center; width: 32px; height: 32px; } 
    .firm-social-media-row a svg { width: 100%; height: 100%; transition: opacity 0.2s, transform 0.2s; }
    .firm-social-media-row a:hover svg { opacity: 0.75; transform: scale(1.1); }

    @media (max-width: 991px) {
        .carousel-arrow.prev { left: 5px; }
        .carousel-arrow.next { right: 5px; }
    }
    @media (max-width: 767px) {
      .product-main-layout { padding: 1.5rem; gap: 1.5rem; }
      .product-title-modern { font-size: 1.75rem; }
      .tab-link-modern { padding: 0.8rem 1rem; font-size: 0.9375rem; }
      .tab-content-modern { padding: 1.5rem; }
      .related-products-title-modern { font-size: 1.5rem; }
      .contact-card-modern { padding: 1.5rem; }
      .contact-grid { grid-template-columns: 1fr; }
      .product-meta-enhanced { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
    }
    @media (max-width: 575px) {
        .product-title-modern { font-size: 1.5rem; }
        .breadcrumb-separator { margin: 0 0.4rem; }
        .related-product-card { width: 200px; }
        .product-share-buttons { flex-wrap: wrap; gap: 0.5rem; }
        .tabs-navigation-modern { padding-left: 0.5rem; padding-right: 0.5rem; }
        .tab-link-modern { padding: 0.75rem 0.8rem; font-size: 0.9rem; }
    }

    footer {
      font-family: 'Satoshi', sans-serif;
      background-color: #ffffff; 
      padding: 40px clamp(1.25rem, 5vw, 5rem);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      font-size: 16px;
      border-top: 1px solid #e0e0e0; 
      color: var(--original-header-text-color);
    }
    .footer-left { display: flex; flex-direction: column; max-width: 45%; }
    .footer-brand { display: flex; align-items: center; margin-bottom: 12px; }
    .footer-brand img { height: 48px; margin-right: 12px; }
    .footer-brand h1 { font-size: 25px; font-weight: 500; color: var(--original-header-text-color); margin: 0; white-space: nowrap; }
    .footer-slogan { font-size: 18px; color: #555555; font-weight: 400; } 
    .footer-right { display: grid; grid-template-columns: auto auto; gap: 12px 40px; }
    .footer-right a { font-weight: 500; font-size: 16px; color: #474747; text-decoration: none; transition: color 0.3s ease; } 
    .footer-right a:hover { color: var(--original-header-text-color); text-decoration: none; }
    .footer-bottom {
      font-family: 'Satoshi', sans-serif;
      background-color: #f9f9f9; 
      text-align: center;
      padding: 20px 40px;
      font-size: 14px;
      color: #474747;  
      border-top: 1px solid #e0e0e0; 
    }
    .footer-bottom a { color: var(--original-header-text-color); font-weight: 500; text-decoration: none; display: inline-flex; align-items: center; }
    .footer-bottom a:hover { text-decoration: none; }
    .footer-bottom a img { height: 24px; margin-left: 8px; }
    @media (max-width: 768px) {
      footer { flex-direction: column; align-items: center; padding: 30px 20px; text-align: center; }
      .footer-left { max-width: 100%; align-items: center; margin-bottom: 30px; }
      .footer-brand { justify-content: center; }
      .footer-right { grid-template-columns: 1fr; gap: 15px; width: 100%; max-width: 280px; text-align: center; }
      .footer-right a { font-size: 18px; } .footer-bottom { padding: 20px; }
    }
    @media (max-width: 480px) {
        .footer-brand h1 { font-size: 22px; } .footer-slogan { font-size: 16px; }
        .footer-bottom { padding: 15px; font-size: 13px; } .footer-bottom a img { height: 20px; }
    }
  </style>
</head>
<body>

<header class="new-site-header" id="newSiteHeader">
  <div class="new-header-content">
    <a href="https://www.serakinci.com" class="new-site-logo-link" title="Serakıncı Ana Sayfa">
      <img src="/urunler/assets/logos/logo.png" alt="Serakıncı Logo" class="new-site-logo-img">
      <span class="new-site-logo-text">Serakıncı Limited</span>
    </a>
    <nav class="new-site-navigation">
      <a href="https://serakinci.com/bizkimiz" class="new-nav-link">Biz Kimiz?</a>
      <a href="https://serakinci.com/services" class="new-nav-link">Hizmetlerimiz</a>
      <a href="https://serakinci.com/careers" class="new-nav-link">Kariyer</a>
      <a href="https://serakinci.com/contact" class="new-nav-link">Bize Ulaşın</a>
    </nav>
    <div class="new-header-actions">
      <button class="language-selector" aria-label="Dil Seçimi">Turkish</button>
      <button class="search-button" aria-label="Genel Site Araması" onclick="alert('Genel site arama fonksiyonu eklenecek.')">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
      </button>
      <a href="https://siparis.serakinci.com/" class="b2b-login-button">B2B Giriş</a>
      <button class="mobile-menu-toggle" aria-label="Menüyü Aç/Kapat" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
    </div>
  </div>
</header>

<main class="product-detail-page">
  <div class="product-search-header">
    <div class="search-bar-container">
      <div class="search-input-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="text" id="productSearchInput" placeholder="Bu kategoride ürün ara...">
      </div>
      <div id="searchResultsDropdown">
        <ul id="searchResultsList"></ul>
      </div>
    </div>
  </div>

  <div class="container" id="productDetailContainer"> 
    <div class="loading-container"> 
      <div class="loading-spinner"></div>
      <p class="loading-text">Ürün bilgileri yükleniyor...</p>
    </div>
  </div>
</main>

<div id="imageLightbox" class="lightbox-modal">
  <span class="lightbox-close" title="Kapat">×</span>
  <img class="lightbox-content" id="lightboxImg" alt="Büyük ürün görseli">
</div>

<button id="scrollToTopBtn" class="scroll-to-top" title="Başa Dön">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
</button>
<div id="copyTooltip" class="copy-tooltip">Kopyalandı!</div>
<div id="favoriteTooltip" class="favorite-tooltip">Favorilere Eklendi!</div>

<footer>
  <div class="footer-left">
    <div class="footer-brand">
      <img src="/urunler/assets/logos/logo.png" alt="Serakıncı Limited Logo" />
      <h1>Serakıncı Limited</h1>
    </div>
    <div class="footer-slogan">
      Hayvan Sağlığı, Cilt Güzelliği — Tek Adreste!
    </div>
  </div>
  <div class="footer-right">
    <a href="https://serakinci.com/">Ana Sayfa</a>
    <a href="https://serakinci.com/bizkimiz">Hakkımızda</a>
    <a href="https://serakinci.com/services">Hizmetlerimiz</a>
    <a href="https://serakinci.com/contact">İletişim</a>
    <a href="https://serakinci.com/careers">Kariyer</a>
    <a href="https://serakinci.com/faq">Sıkça Sorulan Sorular</a>
  </div>
</footer>
<div class="footer-bottom">
  © <span id="currentYear"></span> Serakıncı Limited. Tüm hakları saklıdır. | Powered by
  <a href="https://fures.tech" target="_blank">Fures Tech<img src="/urunler/assets/logos/fureslogo.png" alt="Fures Tech Logo"/></a>
</div>

  <script type="module"> // YENİ: type="module" eklendi
    // YENİ: Gemini SDK import ve kontrolü
    import { GoogleGenerativeAI } from "@google/genai";

    const GEMINI_SDK_LOADED = typeof GoogleGenerativeAI !== 'undefined';

    if (GEMINI_SDK_LOADED) {
        console.log("Google Generative AI SDK (Dermokozmetik) başarıyla yüklendi.");
    } else {
        console.error("KRİTİK HATA: Google Generative AI SDK (Dermokozmetik) yüklenemedi. Lütfen importmap ayarlarını ve tarayıcı konsolunu kontrol edin.");
    }
    
    // YENİ: Gemini API Anahtarı
    const GEMINI_API_KEY = "AIzaSyBEpqKAEZKYSyznxeZsQ1MYO-9hqV5LGoA"; // API anahtarınızı buraya girin

    const segment = 'dermokozmetik';
    let allProducts = [];
    let searchDebounceTimer;
    const defaultImagePath = '/urunler/assets/logos/resimyok.png'; 

    document.getElementById('currentYear').textContent = new Date().getFullYear(); // currentYear footer için

    // YENİ: Akıllı Model Yedeklemesi ile generateEnhancedProductInfo fonksiyonu
    async function generateEnhancedProductInfo(productName, productKategori, languageCode) {
      if (!GEMINI_SDK_LOADED) {
        throw new Error("Yapay zeka modülü (SDK) yüklenemedi. Ek bilgi üretilemiyor.");
      }
      if (GEMINI_API_KEY === "AIzaSyBEpqKAEZKYSyznxeZsQ1MYO-9hqV5LGoA_PLACEHOLDER" || !GEMINI_API_KEY) { 
        console.error("Gemini API anahtarı (Dermokozmetik) yapılandırılmamış!");
        throw new Error("Gemini API anahtarı yapılandırılmamış. Gelişmiş ürün bilgisi üretilemiyor.");
      }

      const genAI = new GoogleGenerativeAI(GEMINI_API_KEY);
      
      const languageInstruction = languageCode === 'tr'
        ? "Lütfen cevabınızı Türkçe olarak oluşturun. JSON anahtarları İngilizce kalmalıdır ('enhancedDescription', 'keyFeatures'). Açıklama ve özellikler Türkçe olmalıdır."
        : "Please generate your response in English. JSON keys should remain in English ('enhancedDescription', 'keyFeatures'). The description and features should be in English.";

      const basePrompt = `
        ${languageInstruction}
        "${productName}" isimli ve "${productKategori || 'Genel Dermokozmetik'}" kategorisindeki bir dermokozmetik ürünü için JSON formatında aşağıdaki bilgileri sağlayın:
        1.  "enhancedDescription": Ürünün detaylı, cilt tipi/sorununa yönelik faydalarını, kullanım amacını ve öne çıkan içeriklerini vurgulayan profesyonel ve bilgilendirici bir açıklaması (yaklaşık 6-8 cümle). Açıklama kullanıcı odaklı ve kolay anlaşılır olmalı.
        2.  "keyFeatures": Ürünün 5-7 adet temel özelliği, faydası veya anahtar içeriği (örneğin, "Hiyalüronik Asit ile yoğun nemlendirme", "Parabensiz ve parfümsüz formül", "Hassas ve alerjik ciltler için özel olarak geliştirilmiştir", "Geniş spektrumlu UVA/UVB koruması SPF50+"). Mümkünse resmi ürün veya marka sayfasının linkini de "Resmi Sayfa: [LINK]" formatında ekleyin.

        Çıktının "enhancedDescription" ve "keyFeatures" anahtarlarına sahip geçerli bir JSON nesnesi olduğundan emin olun.
        Örnek JSON yapısı (değerlerin dili talimata bağlıdır):
        {
          "enhancedDescription": "Ürünün detaylı bir açıklaması...",
          "keyFeatures": ["Özellik 1", "Özellik 2", "Özellik 3", "Resmi Sayfa: https://example.com/urun"]
        }
      `;

      const GEMINI_MODEL_FALLBACK_ORDER = [
        "gemini-flash",
        "gemini-1.5-flash",
        "gemini-1.5-flash-8b"
      ];

      let lastError = null;

      for (const modelName of GEMINI_MODEL_FALLBACK_ORDER) {
        try {
          console.log(`Gemini API'ye (Dermokozmetik) istek gönderiliyor. Model: ${modelName}, Ürün: ${productName}, Kategori: ${productKategori || 'Belirtilmedi'}`);
          const model = genAI.getGenerativeModel({
            model: modelName,
            generationConfig: { responseMimeType: "application/json" }
          });
          
          const result = await model.generateContent(basePrompt); // languageInstruction zaten basePrompt içinde
          const response = result.response;
          let jsonStr = response.text(); 
          console.log(`Gemini API'den (Dermokozmetik) ham yanıt (${modelName}):`, jsonStr);

          const fenceRegex = /^```(?:json)?\s*\n?(.*?)\n?\s*```$/s;
          let match = jsonStr.match(fenceRegex);
          if (match && match[1]) {
            jsonStr = match[1].trim();
          } else {
            jsonStr = jsonStr.trim(); 
          }
          
          const parsedData = JSON.parse(jsonStr);
          console.log(`Ayrıştırılmış JSON verisi (Dermokozmetik - ${modelName}):`, parsedData);

          if (!parsedData.enhancedDescription || !Array.isArray(parsedData.keyFeatures) || parsedData.keyFeatures.some(f => typeof f !== 'string')) {
            console.error(`Gemini API'si (${modelName}) (Dermokozmetik) hatalı JSON döndürdü:`, parsedData);
            throw new Error(`Yapay zekadan (${modelName}) ürün detayları için eksik veya hatalı biçimlendirilmiş veri alındı.`);
          }
          return parsedData;

        } catch (error) {
          console.warn(`Gemini API (Dermokozmetik) hatası (Model: ${modelName}):`, error);
          lastError = error;
          const msgLower = error.message ? error.message.toLowerCase() : "";
          
          if (msgLower.includes("rate limit") || msgLower.includes("resource exhausted") || msgLower.includes("quota") || (error.status && error.status === 429) || msgLower.includes("model_unavailable") || msgLower.includes("try again later") || msgLower.includes("deadline_exceeded") || msgLower.includes("service_unavailable")) { 
            console.log(`Model ${modelName} (Dermokozmetik) için limit/kaynak hatası. Bir sonraki modele geçiliyor.`);
          } else if (msgLower.includes("json") || msgLower.includes("unexpected token")) {
             console.warn(`Model ${modelName} (Dermokozmetik) beklenmedik formatta yanıt verdi. Bir sonraki modele geçiliyor.`);
          } else if (msgLower.includes("api key not valid") || msgLower.includes("permission denied") || msgLower.includes("forbidden") || msgLower.includes("could not find model") || msgLower.includes("developer_message") || msgLower.includes("400 bad request") || msgLower.includes("invalid argument")) { 
            throw new Error(`Kritik API Hatası (Model: ${modelName}) (Dermokozmetik): ${error.message}`); 
          } else {
            console.warn(`Bilinmeyen hata (Model: ${modelName}) (Dermokozmetik). Bir sonraki modele geçiliyor. Detay: ${error.message}`);
          }
        }
      }
      console.error("Tüm yedek modeller (Dermokozmetik) denendi, başarısız oldu.");
      let finalErrorMessage = "Gelişmiş ürün bilgisi (Dermokozmetik) üretilemedi.";
      if (lastError && lastError.message) finalErrorMessage += ` Son hata: ${lastError.message}`;
      throw new Error(finalErrorMessage);
    }


    function slugify(text) {
        if (text === null || typeof text === 'undefined') return '';
        let str = String(text);
        const trMap = { 'ç': 'c', 'Ç': 'C', 'ğ': 'g', 'Ğ': 'G', 'ı': 'i', 'İ': 'I', 'ö': 'o', 'Ö': 'O', 'ş': 's', 'Ş': 'S', 'ü': 'u', 'Ü': 'U' };
        for (let key in trMap) { str = str.replace(new RegExp(key, 'g'), trMap[key]); }
        str = str.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
        str = str.replace(/\//g, ''); 
        str = str.replace(/\./g, '');
        str = str.toLowerCase();
        str = str.replace(/(\d+)\s+(sensibio)/g, '$1$2'); 
        const birimler = 'ml|gr|l|kg|mg|cm|m|lt'; 
        str = str.replace(new RegExp(`\\b(${birimler})\\s+(shower|gel)\\b`, 'gi'), '$1$2'); 
        str = str.replace(new RegExp(`(\\d+)\\s*(${birimler})\\b`, 'gi'), '$1-$2');
        str = str.replace(/\s+/g, '-');      
        str = str.replace(/[^\w-]+/g, '-'); 
        str = str.replace(/--+/g, '-');     
        str = str.replace(/^-+|-+$/g, '');  
        return str || 'isimsiz-urun'; // Eğer slug boş kalırsa
    }

    function getSlugFromUrl() {
      const pathname = window.location.pathname;
      const parts = pathname.split('/');
      if (parts.length >= 5 && parts[3] === 'product' && parts[4]) { return parts[4]; }
      return '';
    }

    document.addEventListener('DOMContentLoaded', function() {
      const menuToggle = document.querySelector('.mobile-menu-toggle');
      const nav = document.querySelector('.new-site-navigation');
      const siteHeader = document.getElementById('newSiteHeader');
      if (menuToggle && nav && siteHeader) {
        menuToggle.addEventListener('click', () => {
          const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
          menuToggle.setAttribute('aria-expanded', String(!isExpanded));
          nav.classList.toggle('is-active');
          if (nav.classList.contains('is-active')) {
            nav.style.top = `${siteHeader.offsetHeight}px`; 
          }
        });
        window.addEventListener('resize', () => {
            if (nav.classList.contains('is-active')) {
                nav.style.top = `${siteHeader.offsetHeight}px`;
            }
        });
      }

      const slugStr = getSlugFromUrl();
      const canonicalLink = document.querySelector("link[rel='canonical']");
      const productDetailContainer = document.getElementById('productDetailContainer');

      if (slugStr) {
        if(canonicalLink) canonicalLink.href = window.location.href;
        if (productDetailContainer) { loadProductDetail(slugStr); }
      } else { 
        if (productDetailContainer) {
            const loadingContainer = productDetailContainer.querySelector('.loading-container');
            if(loadingContainer) loadingContainer.style.display = 'none';
        }
        loadAllProductsForSearch(); 
        if(canonicalLink) canonicalLink.href = window.location.origin + window.location.pathname;
      }
      setupScrollToTopButton();
      setupLightbox();
      setupProductSearch();
    });
    
    async function loadAllProductsForSearch() {
        try {
            const productsResponse = await fetch('/urunler/api/products.json'); 
            if (!productsResponse.ok) throw new Error(`Dermokozmetik ürünleri (arama için) yüklenemedi (${productsResponse.status})`);
            allProducts = await productsResponse.json();
        } catch (error) {
            console.error('Arama için dermokozmetik ürünleri yüklenirken hata:', error);
            allProducts = [];
        }
    }

    async function loadProductDetail(slugFromUrl) {
      const productDetailContainer = document.getElementById('productDetailContainer');
      if (productDetailContainer) {
        productDetailContainer.innerHTML = `<div class="loading-container"><div class="loading-spinner"></div><p class="loading-text">Ürün bilgileri yükleniyor...</p></div>`;
      }

      try {
        if (allProducts.length === 0) { await loadAllProductsForSearch(); }
        if (allProducts.length === 0) {
            showError('Ürün veritabanına erişilemiyor. Lütfen daha sonra tekrar deneyin.');
            return;
        }
        const detailsResponse = await fetch('/urunler/api/detay-product.json');
        if (!detailsResponse.ok) throw new Error(`Ürün detay verileri yüklenemedi (${detailsResponse.status})`);
        const productDetailsData = await detailsResponse.json();
        
        let foundProduct = null;
        for (const p of allProducts) {
            if (!p.ProductName) continue; 
            const productNameSlug = slugify(p.ProductName);
            if (productNameSlug === slugFromUrl) {
                foundProduct = p;
                break;
            }
        }

        if (foundProduct) {
          const productDetail = productDetailsData.find(detail =>
            detail.ProductId === foundProduct.ProductId ||
            (detail.ProductName && slugify(detail.ProductName) === slugify(foundProduct.ProductName))
          );
          displayProductDetail(foundProduct, productDetail); // AI çağrısı displayProductDetail içinde yapılacak
          document.title = `${foundProduct.ProductName} | Dermokozmetik | Serakıncı`;
          updateMetaTags(foundProduct, productDetail);
        } else {
          console.warn(`loadProductDetail (dermokozmetik): "${slugFromUrl}" slug'ı ile ürün bulunamadı.`);
          showError('Aradığınız ürün bulunamadı veya bağlantı hatalı. Lütfen kontrol edin.');
        }
      } catch (error) {
        console.error('loadProductDetail (dermokozmetik): Ürün yüklenirken hata:', error);
        showError(`Ürün yüklenirken bir hata oluştu. Lütfen daha sonra tekrar deneyin.`);
      }
    }
    
    function updateMetaTags(product, productDetail) {
        const ogUrlMeta = document.querySelector('meta[property="og:url"]');
        if (ogUrlMeta) ogUrlMeta.content = window.location.href;

        const ogTitleMeta = document.querySelector('meta[property="og:title"]');
        if (ogTitleMeta) ogTitleMeta.content = `${product.ProductName} | Dermokozmetik | Serakıncı`;
        
        const twitterTitleMeta = document.querySelector('meta[name="twitter:title"]');
        if (twitterTitleMeta) twitterTitleMeta.content = `${product.ProductName} | Dermokozmetik | Serakıncı`;

        const description = product.ProductShortDescription || `Serakıncı'da ${product.ProductName} dermokozmetik ürününü inceleyin.`;
        const descMeta = document.querySelector('meta[name="description"]');
        if (descMeta) descMeta.content = description;
        const ogDescMeta = document.querySelector('meta[property="og:description"]');
        if (ogDescMeta) ogDescMeta.content = description;
        const twitterDescMeta = document.querySelector('meta[name="twitter:description"]');
        if (twitterDescMeta) twitterDescMeta.content = description;

        const imageUrl = product.ImageUrl || (product.ProductImages && product.ProductImages.length > 0 ? product.ProductImages[0].ImageUrl : defaultImagePath);
        if (imageUrl) {
            try {
              const absoluteImageUrl = new URL(imageUrl, window.location.origin).href;
              const ogImageMeta = document.querySelector('meta[property="og:image"]');
              if (ogImageMeta) ogImageMeta.content = absoluteImageUrl;
              const twitterImageMeta = document.querySelector('meta[name="twitter:image"]');
              if (twitterImageMeta) twitterImageMeta.content = absoluteImageUrl;
            } catch (e) {
              console.warn("Geçersiz resim URL'si (meta):", imageUrl, e);
              const absoluteDefaultImageUrl = new URL(defaultImagePath, window.location.origin).href;
              const ogImageMeta = document.querySelector('meta[property="og:image"]');
              if (ogImageMeta) ogImageMeta.content = absoluteDefaultImageUrl;
              const twitterImageMeta = document.querySelector('meta[name="twitter:image"]');
              if (twitterImageMeta) twitterImageMeta.content = absoluteDefaultImageUrl;
            }
        }
        
        const schemaScript = document.querySelector('script[type="application/ld+json"]');
        if (schemaScript) {
            try {
                const schemaData = JSON.parse(schemaScript.textContent);
                schemaData.name = product.ProductName;
                schemaData.description = description;
                if (imageUrl) { try { schemaData.image = new URL(imageUrl, window.location.origin).href; } catch(e){ schemaData.image = new URL(defaultImagePath, window.location.origin).href; } }
                if (product.brand) schemaData.brand = { "@type": "Brand", "name": product.brand };
                schemaScript.textContent = JSON.stringify(schemaData, null, 2);
            } catch (e) {
                console.error("Schema.org JSON parse/update error:", e);
            }
        }
    }

    function displayProductDetail(product, productDetail) {
      const detailContainer = document.getElementById('productDetailContainer');
      if (!detailContainer) return; 
      
      let imageUrl = product.ImageUrl || (product.ProductImages && product.ProductImages.length > 0 ? product.ProductImages[0].ImageUrl : '');
      const finalImageUrl = imageUrl ? imageUrl : defaultImagePath;

      const imageHTML = 
        `<div class="product-main-image-wrapper" id="mainProductImageWrapper">
            <img src="${finalImageUrl}" alt="${product.ProductName}" class="product-main-image-modern" onerror="this.onerror=null; this.src='${defaultImagePath}';">
         </div>`;
      
      const favoriteButtonHTML = `
        <button class="favorite-button" id="favoriteBtn" title="Favorilere Ekle/Çıkar">
            <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        </button>`;

      let metaInfoHTML = '<div class="product-meta-enhanced">';
      if (product.brand) metaInfoHTML += `<span class="meta-item"><strong>Marka:</strong> ${product.brand}</span>`;
      if (product.cat) metaInfoHTML += `<span class="meta-item"><strong>Kategori:</strong> ${product.cat}</span>`;
      const productCode = productDetail?.DisplayProductCode || product.ProductCode;
      if (productCode) metaInfoHTML += `<span class="meta-item"><strong>Ürün Kodu:</strong> <span id="productCodeValue">${productCode}</span> <span class="copy-code" title="Kodu Kopyala" onclick="copyProductCode(event)">(Kopyala)</span></span>`;
      metaInfoHTML += '</div>';
      if (metaInfoHTML === '<div class="product-meta-enhanced"></div>') metaInfoHTML = '';

      const productUrl = window.location.href;
      const shareText = encodeURIComponent(`Serakıncı'da ${product.ProductName} ürününü inceleyin:`);
      let shareButtonsHTML = `
        <div class="product-share-buttons">
          <span class="share-label">Paylaş:</span>
          <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(productUrl)}" target="_blank" rel="noopener" title="Facebook'ta Paylaş">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#1877F2"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>
          </a>
          <a href="https://twitter.com/intent/tweet?url=${encodeURIComponent(productUrl)}&text=${shareText}" target="_blank" rel="noopener" title="Twitter'da Paylaş"><svg viewBox="0 0 24 24"><path fill="#1DA1F2" d="M22.46 6c-.77.35-1.6.58-2.46.67.9-.53 1.59-1.37 1.92-2.38-.84.5-1.78.86-2.79 1.07C18.28 4.47 17.03 4 15.64 4c-2.97 0-5.32 2.44-5.32 5.45 0 .42.05.84.14 1.24C7.08 10.5 4.07 8.76 2.05 6.12c-.44.75-.69 1.62-.69 2.55 0 1.88 1 3.55 2.4 4.52-.88-.03-1.7-.27-2.42-.66v.07c0 2.63 1.85 4.82 4.3 5.32-.45.12-.93.18-1.42.18-.34 0-.68-.03-1-.1C4.56 19.95 6.43 21.3 8.63 21.3c-1.84 1.44-4.17 2.3-6.7 2.3-.43 0-.86-.02-1.28-.08C3.38 22.89 5.92 24 8.78 24c7.22 0 11.6-6.12 11.12-12.07.79-.57 1.47-1.29 2-2.06z"/></svg></a>
          <a href="https://api.whatsapp.com/send?text=${shareText} ${encodeURIComponent(productUrl)}" target="_blank" rel="noopener" title="WhatsApp'ta Paylaş"><svg viewBox="0 0 24 24"><path fill="#25D366" d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.38 1.25 4.8L2 22l5.29-1.38c1.37.71 2.93 1.12 4.56 1.12h.1c5.46 0 9.91-4.45 9.91-9.91S17.68 2 12.04 2zm4.64 12.13c-.14-.07-.86-.42-1-.49-.14-.07-.24-.11-.34.11-.1.22-.38.49-.47.59-.09.1-.18.11-.34.04-.16-.07-.68-.25-1.29-.79-.48-.42-.79-.94-.88-1.1s-.09-.25 0-.38c.08-.11.18-.28.28-.42.09-.14.14-.25.2-.42.07-.18.04-.33-.02-.44s-.34-.81-.47-1.1c-.12-.29-.25-.25-.34-.25-.09 0-.18 0-.28.02s-.24.11-.38.38c-.14.28-.54.86-.54 1.5s.54 1.74.62 1.86c.08.11.97 1.48 2.42 2.03.34.14.61.21.82.28.29.09.54.08.74.02.22-.07.68-.28.78-.55.1-.28.1-.51.07-.59s-.14-.11-.3-.18z"/></svg></a>
        </div>`;
      
      const shortDescriptionText = product.ProductShortDescription || `"${product.ProductName}" Serakıncı güvencesiyle Kuzey Kıbrıs'ta sizlerle. Cilt tipinize uygun en iyi dermokozmetik ürünlerini keşfedin.`;
      let shortDescriptionHTML = `<div class="product-short-description"><p>${shortDescriptionText}</p></div>`;
      
      // YENİ: AI içerik placeholder'ı
      const aiContentPlaceholderHTML = `<div id="aiProductInfoPlaceholder"><p>Yapay zeka ile ürün bilgileri hazırlanıyor...</p></div>`;

      let tab1_HTML = '', tab2_HTML = '', tab3_HTML = '';
      const descContent = productDetail && productDetail["Ürün Açıklaması"] ? productDetail["Ürün Açıklaması"] : `${product.ProductName} hakkında temel bilgiler.`;
      tab1_HTML += (descContent.length > 250) ? `<h3>Ürün Açıklaması</h3><div class="toggle-content" id="descToggle"><div>${descContent}</div></div><button class="read-more-btn" onclick="toggleReadMore('descToggle', this)">Devamını Oku</button>` : `<h3>Ürün Açıklaması</h3><div>${descContent}</div>`;
      
      const producerInfo = productDetail && productDetail["Üretici Firma"] ? productDetail["Üretici Firma"] : "Bu ürün için üretici firma bilgisi belirtilmemiştir.";
      tab2_HTML += `<h3>Ek Bilgiler</h3><div><p><strong>Üretici/Marka:</strong> ${product.brand || producerInfo}</p></div>`;
      
      const warningContent = productDetail && productDetail["Dikkat edilmesi gerekenler ya da uyarılar"] ? productDetail["Dikkat edilmesi gerekenler ya da uyarılar"] : "Bu ürün için özel kullanım talimatı veya uyarı belirtilmemiştir. Genel ürün kullanım tavsiyelerine uyunuz.";
      tab3_HTML += (warningContent.length > 250) ? `<h3>Kullanım Şekli ve Uyarılar</h3><div class="toggle-content" id="warningToggle"><div>${warningContent}</div></div><button class="read-more-btn" onclick="toggleReadMore('warningToggle', this)">Devamını Oku</button>` : `<h3>Kullanım Şekli ve Uyarılar</h3><div>${warningContent}</div>`;

      const relatedProductsTitle = product.cat ? `"${product.cat}" Kategorisindeki Diğer Ürünler` : "Benzer Ürünler";
      const relatedProducts = allProducts.filter(p => p.ProductName && p.cat === product.cat && slugify(p.ProductName) !== slugify(product.ProductName)).slice(0, 10);
      let relatedProductsHTML = '';
      if (relatedProducts.length > 0) {
        relatedProductsHTML = `<div class="related-products-section-modern"><h2 class="related-products-title-modern">${relatedProductsTitle}</h2><div class="related-products-carousel"><div class="carousel-arrow prev" onclick="scrollCarousel(-1)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></div><div class="related-products-container" id="relatedProductsContainer">`;
        relatedProducts.forEach(rp => {
          let rpImageUrl = rp.ImageUrl || (rp.ProductImages && rp.ProductImages.length > 0 ? rp.ProductImages[0].ImageUrl : defaultImagePath);
          relatedProductsHTML += `<a href="/urunler/${segment}/product/${slugify(rp.ProductName)}/" class="related-product-card"><img src="${rpImageUrl}" alt="${rp.ProductName}" onerror="this.onerror=null; this.src='${defaultImagePath}';"><div class="info"><div class="name">${rp.ProductName}</div><div class="category">${rp.cat || 'Belirtilmemiş'}</div></div></a>`;
        });
        relatedProductsHTML += `</div><div class="carousel-arrow next" onclick="scrollCarousel(1)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></div></div></div>`;
      } else {
        relatedProductsHTML = `<div class="related-products-section-modern"><h2 class="related-products-title-modern">${relatedProductsTitle}</h2><p style="text-align:center; color:var(--text-medium); padding:1rem 0;">Bu kategoriye ait başka ürün bulunmamaktadır.</p></div>`;
      }

      const disclaimerHTML = `
      <div class="disclaimer-box-modern">
        <strong>Yasal Uyarı</strong>
        <span>Bu sitede yer alan ürün bilgilerinin tamamı genel bilgilendirme amaçlıdır ve profesyonel bir sağlık uzmanı tavsiyesinin yerini almaz. Ürünlerin kullanımı öncesinde mutlaka doktorunuza veya eczacınıza danışınız. Serakıncı Limited, ürün içerikleri ve açıklamalarının doğruluğu veya güncelliği konusunda herhangi bir sorumluluk kabul etmez. Ürün bilgileri zamanla değişebilir, en güncel bilgi için üretici firma ve resmi ürün kılavuzu dikkate alınmalıdır.</span>
      </div>`;
      
      const contactHTML = `
      <div class="contact-card-modern">
        <div class="contact-title-modern">Bizimle İletişime Geçin</div>
        <div class="contact-bar-modern"></div>
        <p class="contact-intro-text">Ürünlerimiz veya hizmetlerimiz hakkında daha fazla bilgi almak, soru sormak veya öneride bulunmak için aşağıdaki kanallardan bize ulaşabilirsiniz:</p>
        <div class="contact-grid">
          <div class="contact-item"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" /></svg><div><span class="contact-label-modern">Telefon</span><a href="tel:+903923662594" class="contact-link-modern">+90 392 366 25 94</a></div></div>
          <div class="contact-item"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg><div><span class="contact-label-modern">E-posta</span><a href="mailto:info@serakinci.com" class="contact-link-modern">info@serakinci.com</a></div></div>
          <div class="contact-item"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg><div><span class="contact-label-modern">Adres</span><span class="contact-address-text">Sht. Ziya Sok. No:1-2 99450<br>Gazimağusa - KKTC, Mersin 10 Turkey</span></div></div>
          <div class="contact-item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21.45 17.36c-.32-.1-.66-.16-1-.16-1.02 0-2.04.21-2.97.64-.34.16-.73.08-1-.16l-3.28-3.28c.43-.93.64-1.95.64-2.97 0-.34-.06-.68-.16-1l3.28-3.28c.24-.23.32-.62.16-1-.43-.93-.64-1.95-.64-2.97 0-.34.06-.68.16-1 .09-.28.03-.59-.18-.8l-1.09-1.09c-.21-.21-.52-.27-.8-.18-1 .1-1.98.38-2.87.82-.09.04-.18.07-.26.12L5.12 7.25c-.04.09-.07.17-.12.26C4.18 8.4 3.9 9.38 3.81 10.38c-.09.28-.03.59.18.8l1.09 1.09c.21.21.52.27.8.18 1-.1 1.98-.38 2.87-.82.09-.04.18.07.26-.12l5.75-5.75c.04-.09.07-.17.12-.26.89-.44 1.87-.72 2.87-.82.28-.09.59-.03.8.18l1.09 1.09c.21.21.27.52.18.8-.1 1-.38 1.98-.82 2.87-.04-.09-.07.18-.12.26L10.38 17c-.09.04-.17.07-.26.12-.89.44-1.87.72-2.87.82-.28.09-.59-.03-.8-.18l-1.09-1.09c-.21-.21-.27-.52-.18-.8.1-1 .38-1.98.82 2.87.04-.09.07.18.12-.26l.01-.01c.01 0 .01 0 0 0L17 5.12c.09-.04.17-.07.26-.12.9-.43 1.88-.64 2.9-.64.34 0 .68.06 1 .16.28.09.5.29.62.56.15.34.17.73.05 1.07-.27.78-.63 1.52-1.06 2.2-.01.01-.01.02-.02.03l-5.52 5.52c-.01.01-.02.01-.03.02-.68.43-1.42.79-2.2 1.06-.34.12-.62.34-.75.62s-.16.61-.05 1.07c.27.78.63 1.52 1.06 2.2.01.01.01.02.02.03l.01.01c.01 0 .01 0 0 0zM6.5 10.5c0 .28.22.5.5.5s.5-.22.5-.5-.22-.5-.5-.5-.5.22-.5.5z"/></svg><div><span class="contact-label-modern">Fax</span><a href="fax:+903923661585" class="contact-link-modern">+90 392 366 15 85</a></div></div>
        </div>
        <div class="firm-social-media">
            <span class="social-label">Sosyal Medyada Biz</span>
            <div class="firm-social-media-row">
                <a href="https://www.facebook.com/cyprusdermocosmetic/" target="_blank" rel="noopener" title="Dermokozmetik Facebook">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#1877F2"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>
                </a>
                <a href="https://www.instagram.com/serakincidermokozmetik/" target="_blank" rel="noopener" title="Dermokozmetik Instagram">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="none" fill="none" stroke-linecap="round" stroke-linejoin="round">
                       <defs>
                           <radialGradient id="instaGradientDermoPage" cx="30%" cy="107%" r="150%" fx="30%" fy="107%">
                                <stop offset="0%" stop-color="#fdf497"/>
                                <stop offset="5%" stop-color="#fdf497"/>
                                <stop offset="45%" stop-color="#fd5949"/>
                                <stop offset="60%" stop-color="#d6249f"/>
                                <stop offset="90%" stop-color="#285AEB"/>
                            </radialGradient>
                        </defs>
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <rect fill="url(#instaGradientDermoPage)" width="20" height="20" x="2" y="2" rx="5" ry="5"/>
                        <path stroke="#fff" stroke-width="1.8" d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zm1.5-4.88h.01"/>
                    </svg>
                </a>
            </div>
        </div>
      </div>`;

      detailContainer.innerHTML = `
        <nav class="breadcrumbs">
          <a href="https://www.serakinci.com" class="breadcrumb-link">Ana Sayfa</a><span class="breadcrumb-separator">></span>
          <a href="/urunler/" class="breadcrumb-link">Ürün Kataloğu</a><span class="breadcrumb-separator">></span>
          <a href="/urunler/${segment}/" class="breadcrumb-link">${segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ')}</a>
          ${product.cat ? `<span class="breadcrumb-separator">></span> <a href="/urunler/${segment}/?kategori=${slugify(product.cat)}" class="breadcrumb-link">${product.cat}</a>` : ''}
          <span class="breadcrumb-separator">></span><span class="breadcrumb-current">${product.ProductName}</span>
        </nav>
        <div class="product-main-layout">
          <div class="product-gallery-modern">${imageHTML}</div>
          <div class="product-info-modern">
            <div class="product-title-wrapper"><h1 class="product-title-modern">${product.ProductName}</h1>${favoriteButtonHTML}</div>
            ${metaInfoHTML}
            ${shareButtonsHTML}
            ${shortDescriptionHTML}
            ${aiContentPlaceholderHTML} 
          </div>
        </div>
        <div class="product-details-tabs-modern">
          <div class="tabs-navigation-modern">
            <button class="tab-link-modern active" data-tab="tab1">Ürün Detayları</button>
            <button class="tab-link-modern" data-tab="tab2">Ek Bilgiler</button>
            <button class="tab-link-modern" data-tab="tab3">Kullanım ve Uyarılar</button>
          </div>
          <div class="tab-content-modern">
            <div id="tab1" class="tab-pane-modern active">${tab1_HTML || "<p>Detay bulunamadı.</p>"}</div>
            <div id="tab2" class="tab-pane-modern">${tab2_HTML || "<p>Ek bilgi bulunamadı.</p>"}</div>
            <div id="tab3" class="tab-pane-modern">${tab3_HTML || "<p>Uyarı bulunamadı.</p>"}</div>
          </div>
        </div>
        ${relatedProductsHTML}
        ${disclaimerHTML}
        ${contactHTML}
        <a href="/urunler/${segment}/" class="back-button-modern"><span class="back-icon">←</span> Tüm ${segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ')} Ürünlerine Dön</a>
      `;

      const tabLinks = detailContainer.querySelectorAll('.tab-link-modern');
      const tabPanes = detailContainer.querySelectorAll('.tab-pane-modern');
      tabLinks.forEach(link => {
        link.addEventListener('click', () => {
          const targetTab = link.getAttribute('data-tab');
          tabLinks.forEach(tl => tl.classList.remove('active'));
          link.classList.add('active');
          tabPanes.forEach(pane => pane.id === targetTab ? pane.classList.add('active') : pane.classList.remove('active'));
        });
      });

      const mainImageWrapper = document.getElementById('mainProductImageWrapper');
      const mainImageElement = mainImageWrapper ? mainImageWrapper.querySelector('img') : null;
      if (mainImageElement && mainImageElement.src && !mainImageElement.src.endsWith(defaultImagePath.split('/').pop())) { 
        mainImageWrapper.onclick = function() {
          document.getElementById('lightboxImg').src = mainImageElement.src;
          document.getElementById('imageLightbox').classList.add('show');
          document.body.style.overflow = 'hidden';
        }
      }
      
      const favBtn = document.getElementById('favoriteBtn');
      if (favBtn) {
        const productId = product.ProductId || slugify(product.ProductName);
        const favorites = JSON.parse(localStorage.getItem('favorites') || '{}');
        if (favorites[productId]) { favBtn.classList.add('favorited'); }

        favBtn.onclick = function(event) {
            favBtn.classList.toggle('favorited');
            const isFavorited = favBtn.classList.contains('favorited');
            if (isFavorited) { favorites[productId] = true; } 
            else { delete favorites[productId]; }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            const message = isFavorited ? 'Favorilere eklendi!' : 'Favorilerden çıkarıldı!';
            showTooltip(favBtn, message, 'favoriteTooltip');
        };
      }

      // YENİ: AI Bilgisi Çekme ve Gösterme
      const aiPlaceholderDiv = document.getElementById('aiProductInfoPlaceholder');
      if (GEMINI_SDK_LOADED && aiPlaceholderDiv) {
        generateEnhancedProductInfo(product.ProductName, product.cat || 'Dermokozmetik', 'tr')
            .then(aiData => {
                let aiHtml = `<div id="aiProductInfo">`;
                aiHtml += `<h4>Ürün Bilgileri:</h4>`;
                aiHtml += `<p><strong>Detaylı Açıklama:</strong> ${aiData.enhancedDescription}</p>`;
                aiHtml += `<p><strong>Öne Çıkan Özellikler:</strong></p><ul>`;
                aiData.keyFeatures.forEach(feature => {
                    const linkRegex = /\[(.*?)\]\((.*?)\)/g; // Markdown link formatı [text](url)
                    const featureHtml = feature.replace(linkRegex, '<a href="$2" target="_blank" rel="noopener noreferrer" style="color: var(--primary-theme); text-decoration: underline;">$1</a>');
                    aiHtml += `<li>${featureHtml}</li>`;
                });
                aiHtml += `</ul></div>`;
                aiPlaceholderDiv.innerHTML = aiHtml;
            })
            .catch(error => {
                console.error("AI Bilgisi Getirme Hatası (Dermokozmetik):", error);
                aiPlaceholderDiv.innerHTML = `<div id="aiProductInfo" class="error-message"><p><em>Yapay zeka ile ürün bilgisi oluşturulurken bir sorun oluştu: ${error.message}.<br>Lütfen tarayıcı konsolunu (F12 ile açılır) kontrol edin veya daha sonra tekrar deneyin.</em></p></div>`;
            });
      } else if (aiPlaceholderDiv) {
         aiPlaceholderDiv.innerHTML = `<div id="aiProductInfo" class="error-message"><p><em>Yapay zeka modülü (SDK) yüklenemediği için ek bilgi üretilemedi. Lütfen internet bağlantınızı ve tarayıcı konsolundaki (F12) hata mesajlarını kontrol edin.</em></p></div>`;
      }
    }

    function showError(msg) {
      const detailContainer = document.getElementById('productDetailContainer');
      if (!detailContainer) { return; }
      detailContainer.innerHTML = `<div class="error-container"><h2>Bir Sorun Oluştu</h2><p>${msg}</p><a href="/urunler/${segment}/" class="back-button-modern" style="margin-top:1rem;"><span class="back-icon">←</span> ${segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ')} Ürünlerine Dön</a></div>`;
    }
    
    function showTooltip(anchorElement, message, tooltipId) {
        const tooltip = document.getElementById(tooltipId);
        if (!tooltip) return;
        tooltip.textContent = message;
        const rect = anchorElement.getBoundingClientRect();
        tooltip.style.left = `${rect.left + window.scrollX + (rect.width / 2) - (tooltip.offsetWidth / 2)}px`;
        tooltip.style.top = `${rect.top + window.scrollY - tooltip.offsetHeight - 8}px`;
        tooltip.classList.add('show');
        setTimeout(() => { tooltip.classList.remove('show'); }, 2000);
    }

    function setupLightbox() {
        const lightbox = document.getElementById('imageLightbox');
        const lightboxClose = lightbox.querySelector('.lightbox-close');
        if (!lightbox || !lightboxClose) return;
        const closeAction = () => { lightbox.classList.remove('show'); document.body.style.overflow = ''; };
        lightboxClose.onclick = closeAction;
        lightbox.onclick = (event) => { if (event.target === lightbox) closeAction(); }
        document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && lightbox.classList.contains('show')) { closeAction(); } });
    }

    function setupScrollToTopButton() {
        const btn = document.getElementById('scrollToTopBtn');
        if(!btn) return;
        window.onscroll = () => { btn.classList.toggle('show', (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100)); };
        btn.onclick = () => window.scrollTo({top: 0, behavior: 'smooth'});
    }
    
    function copyProductCode(event) {
        const productCodeEl = document.getElementById('productCodeValue');
        if (!productCodeEl) return;
        const productCode = productCodeEl.innerText;
        navigator.clipboard.writeText(productCode).then(() => {
            showTooltip(event.target, 'Ürün kodu kopyalandı!', 'copyTooltip');
        }).catch(err => {
            console.error('Kod kopyalanamadı: ', err);
            showTooltip(event.target, 'Kopyalanamadı!', 'copyTooltip');
        });
    }

    function scrollCarousel(direction) {
        const container = document.getElementById('relatedProductsContainer');
        if (container) {
            const scrollAmount = container.clientWidth * 0.8;
            container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }
    }

    function toggleReadMore(elementId, button) {
        const contentElement = document.getElementById(elementId);
        if (contentElement) {
            contentElement.classList.toggle('expanded');
            button.textContent = contentElement.classList.contains('expanded') ? 'Daha Az Göster' : 'Devamını Oku';
        }
    }

    function setupProductSearch() {
        const searchInput = document.getElementById('productSearchInput');
        const resultsDropdown = document.getElementById('searchResultsDropdown');
        const resultsList = document.getElementById('searchResultsList');

        if (!searchInput || !resultsDropdown || !resultsList) { return; }
        
        if (allProducts.length === 0 && !getSlugFromUrl()) { loadAllProductsForSearch(); }

        searchInput.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLocaleLowerCase('tr-TR');
            clearTimeout(searchDebounceTimer);
            if (searchTerm.length < 2) { resultsDropdown.style.display = 'none'; resultsList.innerHTML = ''; return; }

            searchDebounceTimer = setTimeout(async () => {
                if(allProducts.length === 0) { await loadAllProductsForSearch(); 
                    if (allProducts.length === 0) { resultsList.innerHTML = '<li class="no-results">Ürünler yüklenemedi.</li>'; resultsDropdown.style.display = 'block'; return; }
                }
                const filtered = allProducts.filter(product => product.ProductName && product.ProductName.toLocaleLowerCase('tr-TR').includes(searchTerm));
                resultsList.innerHTML = ''; 
                if (filtered.length > 0) {
                    filtered.slice(0, 7).forEach(product => { 
                        const listItem = document.createElement('li');
                        let rpImageUrl = product.ImageUrl || (product.ProductImages && product.ProductImages.length > 0 ? product.ProductImages[0].ImageUrl : defaultImagePath);
                        listItem.innerHTML = `
                            <a href="/urunler/${segment}/product/${slugify(product.ProductName)}/">
                                <img src="${rpImageUrl}" alt="${product.ProductName}" class="suggestion-image" onerror="this.onerror=null; this.src='${defaultImagePath}';">
                                <span class="suggestion-name">${product.ProductName}</span>
                                ${product.cat ? `<span class="suggestion-category">${product.cat}</span>` : ''}
                            </a>`;
                        resultsList.appendChild(listItem);
                    });
                } else { resultsList.innerHTML = '<li class="no-results">"' + searchTerm + '" için sonuç bulunamadı.</li>'; }
                resultsDropdown.style.display = 'block';
            }, 300); 
        });

        document.addEventListener('click', function(event) {
            if (resultsDropdown && searchInput && !searchInput.contains(event.target) && !resultsDropdown.contains(event.target)) {
                resultsDropdown.style.display = 'none';
            }
        });
        
        if(searchInput) {
            searchInput.addEventListener('focus', function() {
                if (searchInput.value.length >= 2 && resultsList.children.length > 0 && 
                    !(resultsList.firstChild.classList && resultsList.firstChild.classList.contains('no-results')) &&
                    !resultsList.firstChild.textContent.includes("yükleniyor")) {
                     resultsDropdown.style.display = 'block';
                }
            });
        }
    }
  </script>
</body>
</html>
